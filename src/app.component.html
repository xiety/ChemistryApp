<div class="layout-container" [class.mode-fullscreen]="!state.showControls()">

  @if (isLoading()) {
    <div class="global-loading-overlay">
      <div class="spinner-container">
        <div class="spinner-ring"></div>
        <div class="spinner-core"></div>
      </div>
      <div class="loading-text">Loading...</div>
    </div>
  }

  <div class="visualization-viewport">
    <div class="canvas-layer">
      <app-orbital-viewer (ready)="onViewerReady()"></app-orbital-viewer>
    </div>
    <div class="floating-actions">
      <button class="action-button glass-effect" (click)="state.toggleFullScreen()"
        [title]="state.isFullscreen() ? 'Exit Fullscreen' : 'Enter Fullscreen'">
        @if (state.isFullscreen()) {
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3" />
        </svg>
        } @else {
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round"
            d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3" />
        </svg>
        }
      </button>
      <button class="action-button glass-effect" (click)="toggleControls()"
        [title]="state.showControls() ? 'Hide Settings' : 'Show Settings'">
        @if (state.showControls()) {
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
        </svg>
        } @else {
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
        }
      </button>
    </div>
  </div>
  @if (state.showControls()) {
  <aside class="sidebar-panel">
    <app-sidebar></app-sidebar>
  </aside>
  }
</div>
